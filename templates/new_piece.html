{% extends "base.html" %}
{% block content %}
<h2 class="h5 mb-3">New Piece</h2>
<form method="post" action="{{ url_for('create_piece') }}" enctype="multipart/form-data" class="card p-3">
  <div class="row g-3">
    <div class="col-12">
      <label class="form-label">Name</label>
      <input class="form-control" name="name" required>
    </div>
    <div class="col-12 col-md-4">
      <label class="form-label">Type</label>
      <select class="form-select" name="type" id="ptype">
        <option value="pdf">PDF</option>
        <option value="images">Images</option>
      </select>
    </div>

    <div id="pdfsec" class="col-12">
      <label class="form-label">PDF file</label>
      <input class="form-control" type="file" name="pdf_file" accept="application/pdf">
      <div class="form-text">Optional page ranges (e.g. 1-3,5)</div>
      <input class="form-control mt-1" name="page_ranges" placeholder="leave empty for all">
    </div>

    <div id="imgsec" class="col-12" style="display:none">
      <label class="form-label">Image files</label>
      <input class="form-control" type="file" name="image_files" accept="image/*" multiple>
    </div>
  </div>
  <div class="mt-3">
    <button class="btn btn-primary" type="submit">Create</button>
  </div>
</form>
<script>
  const sel = document.getElementById('ptype');
  const pdf = document.getElementById('pdfsec');
  const img = document.getElementById('imgsec');
  function sync() {
    const isPdf = sel.value === 'pdf';
    pdf.style.display = isPdf ? '' : 'none';
    img.style.display = isPdf ? 'none' : '';
  }
  sel.addEventListener('change', sync); sync();
</script>
{% endblock %}
